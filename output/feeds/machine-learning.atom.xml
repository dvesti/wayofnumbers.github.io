<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Way of Numbers - Machine Learning</title><link href="https://wayofnumbers.github.io/" rel="alternate"></link><link href="https://wayofnumbers.github.io/feeds/machine-learning.atom.xml" rel="self"></link><id>https://wayofnumbers.github.io/</id><updated>2019-09-16T20:00:00-05:00</updated><subtitle>Data science for the rest of us.</subtitle><entry><title>How I Trained Computer to Learn Calligraphy Styles: Part 2</title><link href="https://wayofnumbers.github.io/chinese-calligraphy-classifier-2.html" rel="alternate"></link><published>2019-09-16T20:00:00-05:00</published><updated>2019-09-16T20:00:00-05:00</updated><author><name>Michael Li</name></author><id>tag:wayofnumbers.github.io,2019-09-16:/chinese-calligraphy-classifier-2.html</id><summary type="html">&lt;p&gt;Fine-tune model for Chinese Calligraphy Classifier with fast.ai&amp;nbsp;library&lt;/p&gt;</summary><content type="html">&lt;p&gt;Build a Deep Learning Model with fast.ai&amp;nbsp;Library&lt;/p&gt;
&lt;p&gt;&lt;img alt="Photo by Kon Karampelas on Unsplash" src="https://cdn-images-1.medium.com/max/12000/0*gzpUfcpouuU10xO1"&gt;&lt;em&gt;Photo by &lt;a href="https://unsplash.com/@konkarampelas?utm_source=medium&amp;amp;utm_medium=referral"&gt;Kon Karampelas&lt;/a&gt; on &lt;a href="https://unsplash.com?utm_source=medium&amp;amp;utm_medium=referral"&gt;Unsplash&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;I wanted to start a series of posts for the projects I finished/polished for my &lt;a href="https://course.fast.ai/"&gt;Practical Deep Learning for Coders&lt;/a&gt; fast.ai course. Since I’m pretty green on &lt;span class="caps"&gt;ML&lt;/span&gt;/&lt;span class="caps"&gt;DL&lt;/span&gt; field, I hope the challenges I faced and overcome could be of value for other people experiencing the same&amp;nbsp;journey.&lt;/p&gt;
&lt;p&gt;Model &lt;a href="https://medium.com/@lymenlee/deep-learning-models-by-fast-ai-library-c1cccc13e2b3"&gt;1&lt;/a&gt; ・&lt;a href="https://medium.com/datadriveninvestor/chinese-calligraphy-classifier-fine-tuning-cbfbf0e304d8"&gt;1a&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;Making It Even&amp;nbsp;Better&lt;/h3&gt;
&lt;p&gt;In my &lt;a href="https://medium.com/datadriveninvestor/deep-learning-models-by-fast-ai-library-c1cccc13e2b3"&gt;last post&lt;/a&gt;, I explained the approach I take for this image recognition problem using fast.ai library. As you can see, once we get the data down to a fast.ai ImageDataBunch, the code is rather simple and we achieve a 90% accuracy rate, which is quite impressive considering the quality of our data(randomly downloaded from Google/Baidu search without much data cleaning). Now, can we do better?
&lt;a href="https://www.datadriveninvestor.com/2019/03/03/editors-pick-5-machine-learning-books/"&gt;&lt;strong&gt;&lt;span class="caps"&gt;DDI&lt;/span&gt; Editor&amp;#8217;s Pick: 5 Machine Learning Books That Turn You from Novice to Expert | Data Driven…&lt;/strong&gt;
&lt;em&gt;The booming growth in the Machine Learning industry has brought renewed interest in people about Artificial…&lt;/em&gt;www.datadriveninvestor.com&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;h1&gt;Turns out, we&amp;nbsp;can!&lt;/h1&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img alt="" src="https://cdn-images-1.medium.com/max/2000/1*sz46EDt2HU_N2YecCXJ9ng.jpeg"&gt;&lt;/p&gt;
&lt;p&gt;How? Well, there are two things in our prior pipeline that could&amp;nbsp;improve:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Image Pre-processing&amp;nbsp;Tweak&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Model Training Fine&amp;nbsp;Tune.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Let’s dive&amp;nbsp;deeper.&lt;/p&gt;
&lt;h3&gt;Image Pre-Processing&amp;nbsp;Tweak&lt;/h3&gt;
&lt;p&gt;Remember when we import our data into fast.ai ImageDataBunch, we used the following&amp;nbsp;code:&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://cdn-images-1.medium.com/max/2000/0*Prt5fbhL-qj1OoQE.png"&gt;&lt;/p&gt;
&lt;p&gt;Notice that on our image pre-processing, i.e. get_transforms function, we didn’t give it any parameter and just used the default. The default will try to apply a variety of image augmentation techniques to make the image data-set generalize better, like flipping, warping, rotating, cropping, etc. This is good, fast.ai library helped us do the ‘best practice’ for the majority of the cases. But in our case here, some default might not work that&amp;nbsp;well.&lt;/p&gt;
&lt;p&gt;The biggest one is ‘flipping’. Because we are trying to classify calligraphy artworks and in real life, it will never randomly flip left/right or up/down. So making the images flips randomly will not reflect the real-life cases and thus won’t help with our training&amp;nbsp;accuracy.&lt;/p&gt;
&lt;p&gt;To fix this, we tweaked our code as&amp;nbsp;below:&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://cdn-images-1.medium.com/max/2000/1*9Gv0vDlF12MPKznehyU1LA.png"&gt;&lt;/p&gt;
&lt;p&gt;Notice we pass do_flip=False into the get_transforms function, thus telling the module to not randomly flipping our images during&amp;nbsp;importing.&lt;/p&gt;
&lt;h3&gt;Model Training Fine&amp;nbsp;Tune&lt;/h3&gt;
&lt;p&gt;Now that the image pre-processing is done. We can re-structure out model training to avoid overfitting and achieve better accuracy. This approach is introduced in the fast.ai &lt;a href="https://course.fast.ai/"&gt;Practical Deep Learning for Coders&lt;/a&gt; course &lt;a href="https://course.fast.ai/videos/?lesson=3"&gt;lesson 3&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Instead of training the model directly from a 256x256 image size, we’ll gradually scaling up the image size. More concretely, we will first train a &lt;span class="caps"&gt;CNN&lt;/span&gt; to classify the images of 128x128 size, once we achieved best accuracy, we’ll then use transfer learning and keep training the model on the same data-set, except with 256x256 image size. We’ll call the 128x128 image size training ‘stage 1’ and 256x256 image size training ‘stage&amp;nbsp;2’&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;After our stage 1 training(where my &lt;a href="https://medium.com/datadriveninvestor/deep-learning-models-by-fast-ai-library-c1cccc13e2b3"&gt;last post&lt;/a&gt; left off), we have a trained &lt;span class="caps"&gt;CNN&lt;/span&gt; model called learn , it’s ‘unfreezed’ and achieves an accuracy of around&amp;nbsp;85%.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Accuracy 86% after training a 128x128 image size CNN." src="https://cdn-images-1.medium.com/max/2000/1*gereMOAvFIDiK2Mposxw4g.png"&gt;&lt;em&gt;Accuracy 86% after training a 128x128 image size &lt;span class="caps"&gt;CNN&lt;/span&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Now we need to freeze the network again, create a new ImageDataBunch with 256x256 image size and restart the same training&amp;nbsp;process.&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://cdn-images-1.medium.com/max/2000/1*uhQ8i6QTzLJQ1J9EwNtcsg.png"&gt;&lt;/p&gt;
&lt;p&gt;After finding the best learning rate, we train the &lt;span class="caps"&gt;CNN&lt;/span&gt; with another 2 epochs, already breaking into 91% accuracy. We’ll then do the same ‘unfreeze’ and keep&amp;nbsp;training.&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://cdn-images-1.medium.com/max/2000/1*CAwRb2bFZFpgTe8u5UA9JQ.png"&gt;&lt;/p&gt;
&lt;p&gt;After unfreeze, we trained the model with another 4 epochs, the accuracy broke into &lt;strong&gt;96.5%&lt;/strong&gt;. Observed that valudation_losshas already surpassed training_loss, suggesting a sign of overfitting. We’ll stop our training&amp;nbsp;here.&lt;/p&gt;
&lt;p&gt;This simple technique is also called ‘&lt;strong&gt;Progressive resizing&lt;/strong&gt;’ by &lt;a href="undefined"&gt;Jeremy Howard&lt;/a&gt; from &lt;a href="https://www.fast.ai/2018/08/10/fastai-diu-imagenet/"&gt;fast.ai&lt;/a&gt; and helped his team &lt;a href="https://www.theverge.com/2018/5/7/17316010/fast-ai-speed-test-stanford-dawnbench-google-intel"&gt;beat Google in a competition of speed training &lt;span class="caps"&gt;IMAGENET&lt;/span&gt; in *DAWNBench&lt;/a&gt; by training the &lt;span class="caps"&gt;IMAGGNET&lt;/span&gt; in a whopping&lt;strong&gt;18&lt;/strong&gt; minutes and &lt;strong&gt;\$40&lt;/strong&gt; Amazon &lt;span class="caps"&gt;AWS&lt;/span&gt;&amp;nbsp;cost.*&lt;/p&gt;
&lt;h3&gt;To Wrap It&amp;nbsp;Up&lt;/h3&gt;
&lt;p&gt;&lt;img alt="Photo by Franki Chamaki on Unsplash" src="https://cdn-images-1.medium.com/max/8064/0*ccqj05oUPQjsG_Jk"&gt;&lt;em&gt;Photo by &lt;a href="https://unsplash.com/@franki?utm_source=medium&amp;amp;utm_medium=referral"&gt;Franki Chamaki&lt;/a&gt; on &lt;a href="https://unsplash.com?utm_source=medium&amp;amp;utm_medium=referral"&gt;Unsplash&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;With two simple tweaks, we managed to increase the accuracy around 6.5%, breaking into the state-of-the-art range of results. Major&amp;nbsp;takeaways:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;When doing image pre-processing, make sure the processed images still properly represent what real-life data will look&amp;nbsp;like.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The reason gradually increase training image size works is: by giving the trained model a data-set that’s 4 times bigger, actually means giving the model a brand new data to train, avoiding&amp;nbsp;overfitting.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Starting from smaller sized images for training will also have the benefit of faster training and quicker experimenting. This usually leads to better&amp;nbsp;results.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;That’s it for Chinese Calligraphy Classifier. I hope you learned a thing or two after reading these two articles. We’re trying to get some specific calligrapher’s ‘true’ and ‘fake’ artworks and see if we can build a ‘true or false’ classifier. This will be a very interesting and much valuable next step. Will report back and write more articles if we made real progress. But until then, we’ll move on to put this well-trained model into production and build a web-app around it. Stay&amp;nbsp;tuned.&lt;/p&gt;
&lt;p&gt;If you haven’t read my first post on this topic, here’s the link:
&lt;a href="https://medium.com/datadriveninvestor/deep-learning-models-by-fast-ai-library-c1cccc13e2b3"&gt;&lt;strong&gt;How I Trained Computer to Learn Calligraphy Styles: Part1&lt;/strong&gt;
&lt;em&gt;Build a Deep Learning Model with fast.ai Library&lt;/em&gt;medium.com&lt;/a&gt;&lt;/p&gt;</content><category term="Machine Learning"></category><category term="AI"></category><category term="Deep Learning"></category><category term="fast.ai"></category><category term="calligraphy"></category></entry><entry><title>How I Trained Computer to Learn Calligraphy Styles: Part 1</title><link href="https://wayofnumbers.github.io/chinese-calligraphy-classifier-1.html" rel="alternate"></link><published>2019-09-15T20:00:00-05:00</published><updated>2019-09-15T20:00:00-05:00</updated><author><name>Michael Li</name></author><id>tag:wayofnumbers.github.io,2019-09-15:/chinese-calligraphy-classifier-1.html</id><summary type="html">&lt;p&gt;Build a model for Chinese Calligraphy Classifier with fast.ai&amp;nbsp;library&lt;/p&gt;</summary><content type="html">&lt;p&gt;Build a Deep Learning Model with fast.ai&amp;nbsp;Library&lt;/p&gt;
&lt;p&gt;&lt;img alt="Photo by Raychan on Unsplash" src="https://cdn-images-1.medium.com/max/10944/0*1vRfrkhsQiTkkBgJ"&gt;&lt;em&gt;Photo by &lt;a href="https://unsplash.com/@wx1993?utm_source=medium&amp;amp;utm_medium=referral"&gt;Raychan&lt;/a&gt; on &lt;a href="https://unsplash.com?utm_source=medium&amp;amp;utm_medium=referral"&gt;Unsplash&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;I wanted to start a series of posts for the projects I finished/polished for my &lt;a href="https://course.fast.ai/"&gt;Practical Deep Learning for Coders&lt;/a&gt; fast.ai course. Since I’m pretty green on &lt;span class="caps"&gt;ML&lt;/span&gt;/&lt;span class="caps"&gt;DL&lt;/span&gt; field, I hope the challenges I faced and overcome could be of value for other people experiencing the same&amp;nbsp;journey.&lt;/p&gt;
&lt;p&gt;Model &lt;a href="https://medium.com/@lymenlee/deep-learning-models-by-fast-ai-library-c1cccc13e2b3"&gt;1&lt;/a&gt; ・&lt;a href="https://medium.com/datadriveninvestor/chinese-calligraphy-classifier-fine-tuning-cbfbf0e304d8"&gt;1a&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;&lt;strong&gt;Why Build a Chinese Calligraphy&amp;nbsp;Classifier&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;Like any calligraphy, Chinese calligraphy is a form of art. Some great pieces written by some ancient masters have both great art value and economic values (selling at multi-million dollars on&amp;nbsp;auctions).&lt;/p&gt;
&lt;p&gt;&lt;img alt="*Jieshi Tie* by Song Dynasty politician and scholar Zeng Gong, $30,000,000" src="https://cdn-images-1.medium.com/max/2000/1*2lrTyRMYIcm6HfnojdgUvg.jpeg"&gt;*&lt;em&gt;Jieshi Tie&lt;/em&gt; by Song Dynasty politician and scholar Zeng Gong,&amp;nbsp;\$30,000,000*&lt;/p&gt;
&lt;p&gt;There are multiple main styles/schools of calligraphy, mainly belongs to different dynasties. Each has its own way of shaping the character and arranging them. The differences are subtle and abstract. It makes sense to see if a trained deep learning model can do a good job of telling which style it is.
&lt;a href="https://www.datadriveninvestor.com/2019/03/03/editors-pick-5-machine-learning-books/"&gt;&lt;strong&gt;&lt;span class="caps"&gt;DDI&lt;/span&gt; Editor&amp;#8217;s Pick: 5 Machine Learning Books That Turn You from Novice to Expert | Data Driven…&lt;/strong&gt;
&lt;em&gt;The booming growth in the Machine Learning industry has brought renewed interest in people about Artificial…&lt;/em&gt;www.datadriveninvestor.com&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I picked three&amp;nbsp;styles:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Lishu(隶书)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Kaishu(楷书)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Xiaozhuan(小篆)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;as a proof-of-concept. Once successful trained, the model could serve as a transfer learning base-model for the more fine-grained classifier( e.g. calligraphers classifier). This has some real-life value. From time to time, some ancient artifacts are discovered and some of them are calligraphy artworks. Sometimes it’s hard to tell whose work it is. Is it valuable (like undiscovered artwork by a famous&amp;nbsp;calligrapher)?&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;This calligrapher classifier can serve as a way to quickly identify artworks by great calligraphers. ( Finding diamond in the rough &lt;em&gt;😉&lt;/em&gt;)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;Collecting&amp;nbsp;Data&lt;/h3&gt;
&lt;p&gt;To build a calligraphy classifier, we will need some calligraphy examples of each style. I did some search online and cannot find any good already-made data-set for different calligraphy styles. So I’ll have to build it&amp;nbsp;myself.&lt;/p&gt;
&lt;p&gt;Building a images data-set isn’t hard thanks to Google’s Images search functionality and some JavaScript snippets. Here’s&amp;nbsp;how:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Go to &lt;a href="https://www.google.com/imghp?hl=en"&gt;Google Images&lt;/a&gt; and search for “隶书 字帖 网格” (lishu, characters book, grid), this will give you the most relevant&amp;nbsp;results.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Scroll down to show more results, you’ll hit the bottom with ‘&lt;em&gt;Show more results&lt;/em&gt;’ button. Click if you want more, but keep in mind that &lt;strong&gt;700&lt;/strong&gt; images is the maximum&amp;nbsp;here.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img alt="Google search results for Lishu style" src="https://cdn-images-1.medium.com/max/2000/1*uQPNDb-qXO3mYQIHuxitMQ.png"&gt;&lt;em&gt;Google search results for Lishu&amp;nbsp;style&lt;/em&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Now is where the magic happens. Press Ctrl+Shift+J in Windows/Linux and Cmd+Opt+J in Mac to bring up the JavaScript ‘Console’ window of the browser. The following JavaScript snippet will get the URLs of each of the&amp;nbsp;images.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;4) If successfully run, a text file will be downloaded with all the URLs for the images in your search results. You can then set up a folder and use fast.ai’s ‘download_images’ function to download these&amp;nbsp;images.&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://cdn-images-1.medium.com/max/2000/1*19mOhygnBZfGmX4S2fD4ww.png"&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Rinse and repeat for other styles. You might want to put them into different folders like kaishu, xiaozhuan and put them all under a folder called train so later on, fast.ai can easily import them into the&amp;nbsp;model.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Alternatively, you can also go to Baidu.com for images search, using this &lt;a href="https://gist.github.com/wayofnumbers/39842bb909c04070de49e53c418d512f"&gt;snippet&lt;/a&gt; to automatically download the images you searched for. (Code too long to be put into this post, so I link it&amp;nbsp;here).&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;Let’s Have a Look at the&amp;nbsp;Data&lt;/h3&gt;
&lt;p&gt;If you organize the downloaded images into train/lishu, train/kaishu, train/xiaozhuan, then you can run the following code to import them into and transformed accordingly, ready to fit a model.fast.ai’s powerfulImageDataBunch object, where all data is organized, splitted and transformed accordingly, ready to fit a&amp;nbsp;model.&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://cdn-images-1.medium.com/max/2000/1*hsF08GhTX9tjyov8hHzbFw.png"&gt;&lt;/p&gt;
&lt;p&gt;Note that we split the train/validation set with an 80/20 ratio, image resized to 224 which is a good default for any image recognition&amp;nbsp;task.&lt;/p&gt;
&lt;p&gt;Now that data is imported properly, let’s look at our&amp;nbsp;images:&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://cdn-images-1.medium.com/max/2000/1*F378nVvqW7o6lz6QxAB2gA.png"&gt;&lt;/p&gt;
&lt;p&gt;As we can see from the few examples above, the data-set is rather ‘dirty’. The images are not properly cropped, with some side notes with different calligraphy style and some images only have one or two characters. But it’s &lt;span class="caps"&gt;OK&lt;/span&gt;. Let’s quickly train the model and see how it performs so we can gain some insights into our&amp;nbsp;data.&lt;/p&gt;
&lt;h3&gt;Quick and Dirty&amp;nbsp;Training&lt;/h3&gt;
&lt;p&gt;Let’s first create a model. We’ll be using transfer learning and use ResNet50 as our model. Pre-trained weights will be&amp;nbsp;downloaded.&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://cdn-images-1.medium.com/max/2134/1*Zzy9-o-Q3K3BID_vZyRCoA.png"&gt;&lt;/p&gt;
&lt;p&gt;With 3 epoches of fit_one_cycle, we managed to reach a 90% accuracy rate on our validation set. Not&amp;nbsp;bad!&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://cdn-images-1.medium.com/max/2000/1*44IMsadGzm0-mF2SdrvUKA.png"&gt;&lt;/p&gt;
&lt;h3&gt;Unfreeze and Fine-Tune Our&amp;nbsp;Training&lt;/h3&gt;
&lt;p&gt;Since the fit_one_cycle function will freeze the initial layers and only training the last couple of layers to speed up the training speed(this approach works because usually for transfer learning, initial layers will capture basic features of the images that are not likely to change a lot), we can hopefully further improve our accuracy by unfreezing all the layers and train&amp;nbsp;again.&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://cdn-images-1.medium.com/max/2000/1*IxzL6yxuHV2nqmoXure_fg.png"&gt;&lt;/p&gt;
&lt;p&gt;We used the above lr_find function to find a good learning rate range. The key is to find the steepest slope (as indicated in the orange circle above) in the learning curve and slice it for further training. For example, in the above figure, the bottom of the curve is at 1e-03, then we can pick one point at 1/10 of that, which is 1e-04, and the other one at 1e-06 or 1e-05 (This is inspired from an experimental concept of ‘Super-convergence’, described in details in &lt;a href="https://course.fast.ai"&gt;fast.ai course&lt;/a&gt;. Sometime you need to do a bit of experiment to find the best learning rate combination but then again, fast.ai is always preaching iterative and interactive approach.) The idea is still to train the first couple of layers slower and last couple layers&amp;nbsp;faster.&lt;/p&gt;
&lt;p&gt;Let’s train another two&amp;nbsp;epoch:&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://cdn-images-1.medium.com/max/2000/1*noUlINi_AE8NZyZfJ7koBQ.png"&gt;&lt;/p&gt;
&lt;p&gt;Slightly better and the validation_loss starts to surpass train_loss, a sign of overfitting. Let’s stop here and wrap things&amp;nbsp;up.&lt;/p&gt;
&lt;h3&gt;Results&amp;nbsp;Interpretation&lt;/h3&gt;
&lt;p&gt;We reached 90% accuracy. Not state-of-the-art but already pretty impressive considering we only have a roughly 700 images per class data-set. More data will definitely lead to better results. Let’s look at our results and see if we can find some&amp;nbsp;insights.&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://cdn-images-1.medium.com/max/2000/1*tyskbmlwBIE0roKxHHbseA.png"&gt;&lt;/p&gt;
&lt;p&gt;Using the ClassificationIntepretation object from fast.ai, we can easily calculate the top_losses and see what they&amp;nbsp;are:&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://cdn-images-1.medium.com/max/2000/1*3bL7M8zSjT-PLGVTqp3hEg.png"&gt;&lt;/p&gt;
&lt;p&gt;Look at the confusion matrix, the model does really well in recognize ‘xiaozhuan’, probably due to its unique stroke&amp;nbsp;arrangements.&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://cdn-images-1.medium.com/max/2000/1*qtb-Te_AElPaO3mym-9RVw.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;A couple of&amp;nbsp;insights:&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;We still have totally wrong images like the grid one (2nd one on 1st row)
If there are too few (1st row, 1st column) or too many (2nd row, 2nd column) characters, the model will struggle.
Some image shows ‘in-between’ kind of styles which the model also had a hard time classify. Which is totally normal, since even human will have a hard time telling which style it belongs&amp;nbsp;to.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;Final&amp;nbsp;Thoughts&lt;/h3&gt;
&lt;p&gt;This experimental project actually works exceedingly well with fast.ai library. &lt;a href="undefined"&gt;Jeremy Howard&lt;/a&gt; said on the course and I quote here (not exactly word by word, but I hope I captured the gist of it.&amp;nbsp;🙏):&lt;/p&gt;
&lt;blockquote&gt;
&lt;h1&gt;fast.ai is a very opinionated library. Wherever we know a best default, we’ll choose it for you. Whatever best practice we know works well, we’ll do it for&amp;nbsp;you.&lt;/h1&gt;
&lt;/blockquote&gt;
&lt;p&gt;This is at least proven in this project. With only very few lines of code and very minimum efforts for data collection, we managed a 90% accurate model. I believe with more and better quality data. The state-of-the-art results could be achieved and our calligrapher classifier vision is not beyond&amp;nbsp;reach.&lt;/p&gt;
&lt;p&gt;&lt;img alt="fast.ai’s tagline: Making neural nets uncool again." src="https://cdn-images-1.medium.com/max/2400/0*Yo5w5gd2_CRC1MFl.jpg"&gt;&lt;em&gt;fast.ai’s tagline: Making neural nets uncool&amp;nbsp;again.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Finally, allow me to paraphrase above tagline with a Chinese&amp;nbsp;poet:&lt;/p&gt;
&lt;p&gt;&lt;img alt="“Where once the swallows knew the mansions of the great, They now to humbler homes would fly to nest and mate.“" src="https://cdn-images-1.medium.com/max/2000/1*g6k1Z7hyyeW_Y8Ge3GWmWQ.png"&gt;&lt;em&gt;“Where once the swallows knew the mansions of the great, They now to humbler homes would fly to nest and&amp;nbsp;mate.“&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;You could find out how I fine-tuned the model and achieved better accuracy at the link below:
&lt;a href="https://medium.com/datadriveninvestor/chinese-calligraphy-classifier-fine-tuning-cbfbf0e304d8"&gt;&lt;strong&gt;How I Trained Computer to Learn Calligraphy Styles: Part 2&lt;/strong&gt;
&lt;em&gt;Build a Deep Learning Models with fast.ai Library&lt;/em&gt;medium.com&lt;/a&gt;&lt;/p&gt;</content><category term="Machine Learning"></category><category term="AI"></category><category term="Deep Learning"></category><category term="fast.ai"></category><category term="calligraphy"></category></entry><entry><title>Types of Optimization Algorithms used in Neural Networks and Ways to Optimize Gradient Descent</title><link href="https://wayofnumbers.github.io/Typtes-of-optimization-algorithms.html" rel="alternate"></link><published>2018-02-26T17:00:00-06:00</published><updated>2018-02-26T17:00:00-06:00</updated><author><name>Internet</name></author><id>tag:wayofnumbers.github.io,2018-02-26:/Typtes-of-optimization-algorithms.html</id><summary type="html">&lt;p&gt;Types of Optimization Algorithms used in Neural Networks and Ways to Optimize Gradient&amp;nbsp;Descent&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="https://towardsdatascience.com/types-of-optimization-algorithms-used-in-neural-networks-and-ways-to-optimize-gradient-95ae5d39529f"&gt;&lt;strong&gt;Original&amp;nbsp;Story&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://towardsdatascience.com/@anishsingh20"&gt;Anish Singh Walia&lt;/a&gt;:        &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If your input data is sparse then methods such as &lt;strong&gt;&lt;span class="caps"&gt;SGD&lt;/span&gt;,&lt;span class="caps"&gt;NAG&lt;/span&gt; and momentum&lt;/strong&gt; are inferior and perform poorly. &lt;strong&gt;For sparse data sets one should use one of the adaptive learning-rate methods.&lt;/strong&gt; An additional benefit is that we won’t need to adjust the learning rate but likely achieve the best results with the default value.
If one wants fast convergence and train a deep Neural Network Model or a highly complex Neural Network then &lt;strong&gt;Adam or any other Adaptive learning rate techniques&lt;/strong&gt; should be used because they outperforms every other optimization&amp;nbsp;algorithms.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;One thing about Machine Learning the overal depth of the topics and algorithms makes it so easy to totally &lt;em&gt;&amp;#8216;sink&amp;#8217;&lt;/em&gt; yourself into it. And there is always something to dig. This article provides a view from a higher ground and compare different optimization algorithms and their application areas, thus pulling you out of the deep hole of deep&amp;nbsp;learning. &lt;/p&gt;
&lt;p&gt;A more visual example of these algorithms, see these two beautifully crafted&amp;nbsp;animations:&lt;/p&gt;
&lt;p&gt;&lt;img alt="SGD optimization on loss surface contours" src="https://wayofnumbers.github.io/images/optimization-algorithem-1.gif" title="SGD optimization on loss surface contours"&gt;
&lt;div style="text-align: center;"&gt;&lt;span class="caps"&gt;SGD&lt;/span&gt; optimization on loss surface contours&lt;/div&gt;
&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="SGD optimization on saddle point" src="https://wayofnumbers.github.io/images/optimization-algorithem-2.gif" title="SGD optimization on saddle point"&gt;
&lt;div style="text-align: center;"&gt;&lt;span class="caps"&gt;SGD&lt;/span&gt; optimization on saddle point&lt;/div&gt;&lt;/p&gt;</content><category term="machinelearning"></category><category term="AI"></category><category term="Optimization Algorithm"></category><category term="Gradient Descent"></category><category term="Neural Networks"></category></entry><entry><title>The AI Shortage</title><link href="https://wayofnumbers.github.io/The-AI-Shortage.html" rel="alternate"></link><published>2018-02-23T17:00:00-06:00</published><updated>2018-02-23T17:00:00-06:00</updated><author><name>Internet</name></author><id>tag:wayofnumbers.github.io,2018-02-23:/The-AI-Shortage.html</id><summary type="html">&lt;p&gt;&lt;span class="caps"&gt;AI&lt;/span&gt; talent shortage is not getting better any time&amp;nbsp;soon&amp;#8230;&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="https://medium.com/@Moscow25/the-ai-talent-shortage-704d8cf0c4cc"&gt;&lt;strong&gt;Original&amp;nbsp;Story&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://medium.com/@Moscow25"&gt;Nikolai Yakovenko&lt;/a&gt; from &lt;span class="caps"&gt;NVIDIA&lt;/span&gt;:        &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;But when I look for a designer, a Java developer, a real estate agent, etc — some are way better than others and deserve to get paid more than an &lt;span class="caps"&gt;AI&lt;/span&gt; researcher — but you’re fundamentally talking about pulling from a large well-balanced pool. It’s mostly an information game, and a matter of getting a little better than you need, but not much more than you can afford or should be paying.
In &lt;span class="caps"&gt;AI&lt;/span&gt;, it’s different. There just aren’t enough people to go around. And there aren’t enough people for every good project that can be attempted. Either academic, or something that if it works, can save the company&amp;nbsp;$1M.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The booming of a new disruptive technology always did this to the industry as well as the talent pool. It drives money into investing on the next big thing, and the money lures more talents into the field. There will be a shortage in the very beginning, and there will always be a surplus at the end of the curve. I&amp;#8217;m afraid &lt;span class="caps"&gt;AI&lt;/span&gt; won&amp;#8217;t be any different. It&amp;#8217;s just that the curve will take 10 maybe more years to unfold so it&amp;#8217;s not too late to get in the game if you think you have the stuff, since at the end of day, people with talent and grit will win, in every new technology &amp;#8216;gold&amp;nbsp;rush&amp;#8217;. &lt;/p&gt;</content><category term="machinelearning"></category><category term="AI"></category></entry></feed>